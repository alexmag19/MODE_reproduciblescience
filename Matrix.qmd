---
title: "Modèle matrice et applications en écologie"
bibliography: "Quentin, Alexie, Jeanne et Laurane"
execute: 
  freeze: auto
output: 
  html_document:
   toc: true
   toc_float: true
---

Plan projet : 

I. Modélisation matricielle en écologie -> Laurane
A quoi servent les matrices en écologie ?
Transformer une population en matrice
Modifier une matrice de population (addition de population,soustraction)

II. Les grands exemples de matrices en écologie  -> Alex
Classes d’âge et reproduction : Matrice de Leslie
Impact prédateur
Compétition ?

III. Matrice en épidémiologie -> Jeanne

IV. Chaînes de Markov -> Quentin


II/ 
Nous retrouvons maintenant notre famille de suricates 10 ans plus tard. Pendant cette décennie notre population a bien évolué et 
différentes classes d’âges se sont formées. 
Nous avons tout d’abord la classe des juvéniles, notés J qui ont entre 0 et 1 an et qui correspondent aux individus ne possédant pas encore la maturité sexuelle. 
Il n’y qu’une petite partie de ces juvéniles qui parviennent à atteindre la classe d’âge adulte, en suivant un taux de passage noté TPa.
Ensuite nous passons à la classe d’âge des adultes, notés A, qui eux peuvent se reproduire avec un taux de fécondité noté TFa et qui ont tous entre 1 et 10 ans. 
Les femelles suricates adultes survivent d’une année sur l’autre avec un taux de survie noté TSa et il n’y qu’une petite partie de ces femelles qui 
parviennent à atteindre la classe d’âge sénior, en suivant un taux de passage noté TPs. 
Pour le bien de notre histoire, nous allons considérer qu’a partir de 10 ans nos suricates adultes appartiennent à la classe d’âge des seniors, notés S et qu’ils 
ont un taux de fécondité inférieur à celui des adultes, notés TFs.
Les femelles suricates seniors survivent d’une année sur l’autre avec un taux de survie noté TSs. 

Avec toutes ces informations nous pouvons dessiner l’arbre de vie suivant : 

(mettre figure en latex)

Figure 2 : Cycle de vie des suricates

Pour le compléter on estime que : 
-	une femelle suricate adulte va avoir en moyenne 3 petits par an
-	environ 90% des femelles suricates adultes survivent une année sur l’autre, jusqu’à sa dixième année. 
-	une femelle suricate senior va avoir en moyenne 1 petit par an 
-	40 % des femelles suricates seniors qui sont encore vivantes à la fin de onzième année vont survivre, mais pas au-delà d’une douzième année.
-	un juvénile sur deux ne survit pas à sa première année de vie
-	30% des femelles suricates adultes atteignent le stade sénior 
Avec toutes ces informations nous pouvons ainsi compléter notre cycle de vie :

Figure 3 : Cycle de vie des suricates complété 

Si nous notons, pour tout instant t (le temps étant compté en années, de sorte que t est entier), Jt le nombre de suricates juvéniles, 
At celui des adultes et St celui des séniors on aura ainsi :

$$
N_t = J_t + A_t + S_t
$$

le nombre total de suricates dans la population étudiée.
 
Les hypothèses ci-dessus se traduisent par les équations suivantes : 

$$
\begin{align*}
J_{t+1} &= 0 \cdot J_t + TF_a \cdot A_t + TF_s \cdot S_t \\
A_{t+1} &= TP_a \cdot J_t + TS_a \cdot A_t + 0 \cdot S_t \\
S_{t+1} &= 0 \cdot J_t + TP_s \cdot A_t + TS_s \cdot S_t
\end{align*}
$$

Nous pouvons ensuite remplacer par nos valeurs : 

$$
\begin{align*}
J_{t+1} &= 0 \cdot J_t + 3 \cdot A_t + 1 \cdot S_t \\
A_{t+1} &= 0.5 \cdot J_t + 0.9 \cdot A_t + 0 \cdot S_t \\
S_{t+1} &= 0 \cdot J_t + 0.3 \cdot A_t + 0.4 \cdot S_t
\end{align*}
$$

Ce deuxième systeme nous permet ainsi d'établir une matrice.
L'utilisation d'une matrice nous permettra par la suite de déterminer différents paramètres comme le taux de croissance par exemple,
afin de comprendre et de prédire l'évolution de la population dans le temps.
Cette type de matrice a un nom : la matrice de Leslie. 
Le terme "matrice de Leslie" fait référence à l'économiste et démographe britannique Patrick Leslie, qui a introduit cette méthode de 
modélisation démographique dans les années 1940. Initialement développé pour étudier la croissance des populations d'insectes,
elle a ensuite été adaptée et étendue pour être appliquée à la modélisation démographique humaine et animale.

Ainsi, nous pouvons créer cette matrice : 

$$
\begin{bmatrix}
0 & TF_a & TF_s \\
TP_a & TS_a & 0 \\
0 & TP_s & TS_s \\
\end{bmatrix}
$$

Cette matrice est construite de telle sorte à ce que en colonne nous ayons dans l'ordre Jt+1, At+1, St+1 et en ligne Jt, At et St. 
Vous remarquerez ainsi que nous avons sur la première ligne les indicateurs concernant la fécondité de nos individus notés TF.
Sur la diagonale nous aurons parmaètres concernant la survie et sur la diagnoale en dessous ceux concernant les probabilité de passer
d'un stade d'âge, à un autre. 

Ainsi, si nous remplaçons par nos valeurs nous obtenons ainsi la matrice suivante :  

$$
\begin{bmatrix}
0 & 3 & 1 \\
0.5 & 0.9 & 0 \\
0 & 0.3 & 0.4 \\
\end{bmatrix}
$$

Maintenant que nous avons notre matrice nous allons pouvoir la rentrer sur le logiciel R afin de pouvoir faire différents calculs 
que nous detaillerons plus tard : 

Pour rentrer et donc créer notre matrice sur R nous allons écrire les lignes suivantes : 

$$
TF_a = 3
TF_s = 1
TP_a = 0.5
TS_a = 0.9
TP_s = 0.3
TS_s = 0.4
leslie<-c(0,TF_a,TF_s,TP_a,TS_a,0,0,TP_s,TS_s) 
# Avec cette ligne de code nous avons donc créé notre liste nommée leslie, qui comprend tous les paramètres présents dans notre cycle de vie
matrice<-matrix(data=leslie, nrow = 3,ncol = 3, byrow=TRUE, dimnames = ) 
# La fonction matrix() nous permet de transformer cette liste en matrice
$$ 

Ensuite, afin d'effectuer tous les calculs en lien avec notre matrice, nous devons installer un package qui s'appelle popbio

$$
install.packages("popbio")
library(popbio)
$$

Grâce à ce package nous pourrons calculer différents paramètres...

Le premier paramètre que nous allons calculer est le taux de croissance. 
Le taux de croissance est un indicateur démographique qui permet de connaître l'évolution d'une population à un moment donné. 
En l'occurence, dans notre exemple on l'obtient ainsi : 

$$
taux de croissance = lambda(matrice)
$$

On obtient ainsi un taux de croissance de 1.795362. 
Notre taux de croissance est supérieur à 1, ce qui indique que notre population augmente. 
Ce type de taux est généralement associé à des facteurs tels qu'un taux de natalité élevé, une faible mortalité, des migrations nettes positives,
ou une combinaison de ces éléments. Cela indique ainsi que notre population est dynamique et que notre population est en croissance démographique. 
Si le taux de croissance avait été inférieur à 1, cela indiquerait que notre population est en déclin. 
Généralement dans ces types de taux de croissance sont souvent associés à des populations vieillissantes, à des tendances démographiques négatives.
Ce qui n'est pas le cas dans notre population de surricat. 

Maintenant que nous savons que notre population est en croissance démographique, nous allons regarder le temps de génération. 
Le temps de génération correspond au temps moyen pour que chaque individus soit remplacé dans la population. 
Nous allons donc utiliser la fonction generation.time() qui est disponible dans le package popbio. 

$$
temps_de_generation = generation.time(matrice)
# 4.890923
$$

Dans notre cas, le pas de temps que nous avons pris est de 1 an donc nous avons un temps de génération de 4.8 ans.
Le temps de génération représente la durée moyenne entre la naissance d'une génération parentale et la naissance de la génération suivante, 
ce qui nous permet ainsi d'avoir une perspective sur la manière dont les caractéristiques démographiques se transmettent à travers les générations.






le taux de croissance, le temps de génération cad que chaque individu soit remplacer dans chaque la population, 
la strucuture d'age stable, que l'on va pouvoir représenter sur un graphique, le temps que met la popluation que mets pour se rétablir d'une perturbation, 



stable.stage(matrice)
#Pour calculer la strucuture d'age stable qui est de 0.03697187 0.31607121 0.32290968 0.32404724
#ce sont des pourcentages donc 3,7% de stae 1, 32% de stade 2, 32% de matures et 32% d'agés
#representer cela sur un barplot 
barplot(stable.stage(matrice), names.arg = c("yearling","juvenile","mature","postreprod"))
#population pas à l'équilibre 
reproductive.value(matrice)
#pour calculer les valeyurs reproductives de chaque classe 
#1.0000000 1.049045 1.571320 6.002137e-16(=0,000)
#représenter avec barplot 
barplot(reproductive.value(matrice),names.arg = c("yearling","juvenile","mature","postreprod"))
#damping.ratio() * taux(=27) c'est le temps que met la popluation que mets pour se rétablir d'une perturbation
N0a=c(3,31,33,33)
N0b=c(90,3,2,3)
pop.projection(matrice,N0a,20)
pop.projection(matrice,N0b,20)
#$pop.sizes donne la taille de la pop
#$pop.changes donne le taux de croissance 
#pop.projection permet de calculer les effectifs à chaque pas de temp a partir de la matrice et d'un valeur d'effectif initiaux
#Faire plot pour simulation sur 20 ans et 100 ans
#pop.sizes d'abord
plot(pop.projection(matrice,N0a,20)$pop.sizes,type = "l",ylim = c(80,170),ylab="taille de pop",xlab = "année")
plot(pop.projection(matrice,N0b,20)$pop.sizes,type = "l",ylim = c(80,170),ylab="taille de pop",xlab = "année")
lines(pop.projection(matrice,N0b,20)$pop.sizes,type="l",col="red")
lines(pop.projection(matrice,N0a,20)$pop.sizes,type="l",col="black")
legend("topright",legend=c("equilibre","desequilibre"),text.col = c("black","red"))
#la même chose en changeant quelques trucs mais pop.changes
plot(pop.projection(orque,N0a,20)$pop.changes,type = "l",ylim = c(0.96,1.035),ylab="taux de croissance réalisé",xlab = "année")
plot(pop.projection(orque,N0b,20)$pop.changes,type = "l",ylim = c(0.96,1.035),ylab="taux de croissance réalisé",xlab = "année")
lines(pop.projection(orque,N0a,20)$pop.changes,type="l",col="black")
lines(pop.projection(orque,N0b,20)$pop.changes,type="l",col="red")
legend("topright",legend=c("equilibre","desequilibre"),text.col = c("black","red"))

#Analyse de perturbations : étude de la varitation du taux de croissance asymptotique lorsque les paramètres d"mogrpahiques varient
# analyse de sensibilité : variation absolue des parametres
#analyse de'élasticité : variation realtive de paramtres
elasticity(matrice)
$$

parler de l'effet allee et de l'effet d'un prédateur sur la pop, en refaisant les calculs avec des nouveaux taux etc...
expliquer ce que sont tous les calculs qui ont été faits au dessus 